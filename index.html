<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Master Pro - Web Edition</title>
    <style>
        :root { --p-color: #2563eb; --s-color: #10b981; --bg: #f3f4f6; }
        body { font-family: sans-serif; background: var(--bg); margin: 0; display: flex; justify-content: center; }
        #app { width: 100%; max-width: 450px; background: white; min-height: 100vh; position: relative; box-shadow: 0 0 20px rgba(0,0,0,0.1); }
        .top-bar { background: var(--p-color); color: white; padding: 15px; display: flex; justify-content: space-between; align-items: center; font-weight: bold; }
        .coin-box { background: rgba(0,0,0,0.2); padding: 5px 12px; border-radius: 20px; }
        .screen { padding: 20px; display: none; }
        .active { display: flex; flex-direction: column; }
        
        /* Botones de inicio centrados */
        #scr-home { justify-content: center; min-height: 80vh; }
        
        .menu-btn { width: 100%; padding: 15px; margin: 10px 0; border: none; border-radius: 12px; font-size: 1rem; font-weight: bold; cursor: pointer; color: white; transition: 0.3s; }
        .btn-play { background: var(--s-color); }
        .btn-ad { background: #f59e0b; }
        .btn-pay { background: #6366f1; }
        .opt-btn { background: white; border: 2px solid #e5e7eb; width: 100%; padding: 15px; margin: 8px 0; border-radius: 10px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>

<audio id="bg-music" loop>
    <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-8.mp3" type="audio/mpeg">
</audio>

<div id="app">
    <div class="top-bar">
        <span>QUIZ MASTER PRO</span>
        <div class="coin-box">ðŸ’° <span id="coin-count">0</span></div>
    </div>

    <div id="scr-home" class="screen active">
        <button class="menu-btn btn-ad" onclick="verAnuncioBonificado()">ðŸ“º Ver Anuncio (+50 ðŸ’°)</button>
        <button class="menu-btn btn-play" onclick="irA('scr-groups')">ðŸŽ® Jugar</button>
        <button class="menu-btn btn-pay" onclick="irA('scr-shop')">ðŸ’³ Canjear PayPal</button>
    </div>

    <div id="scr-quiz" class="screen">
        <h3 id="q-text">Cargando pregunta...</h3>
        <div id="q-options"></div>
    </div>

    <div id="scr-shop" class="screen">
        <h2>Tienda PayPal</h2>
        <input type="email" id="paypal-email" placeholder="Email de PayPal" style="width:100%; padding:10px; margin-bottom:10px;">
        <button class="menu-btn btn-pay" onclick="procesarPago('0.50', 14000)">Retirar 0.50â‚¬ (14.000ðŸ’°)</button>
        <button class="menu-btn" style="background:#6b7280" onclick="irA('scr-home')">Volver</button>
    </div>
</div>

<script>
    // IDs DE ADMOB (Configurados en la lÃ³gica)
    const APP_ID = "ca-app-pub-6417146963108410~1758942755";
    const INTERSTICIAL_ID = "ca-app-pub-6417146963108410/9028736728";
    const REWARDED_ID = "ca-app-pub-6417146963108410/4448146271";

    let monedas = parseInt(localStorage.getItem('monedas')) || 0;
    let contadorPreguntas = 0;

    function actualizarMonedas() {
        document.getElementById('coin-count').innerText = monedas;
        localStorage.setItem('monedas', monedas);
    }

    function irA(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        // Iniciar mÃºsica al primer clic
        document.getElementById('bg-music').play().catch(() => {});
    }

    // LÃ“GICA DE ANUNCIOS ðŸ“º
    function verAnuncioBonificado() {
        // Enviamos seÃ±al a Niotron para mostrar recompensado
        if(window.AppInventor) {
            window.AppInventor.setWebViewString("MOSTRAR_RECOMPENSADO");
        }
        // SimulaciÃ³n para web (quitar en producciÃ³n)
        else { alert("Simulando anuncio... +50 monedas"); darRecompensa(50); }
    }

    function darRecompensa(cantidad) {
        monedas += cantidad;
        actualizarMonedas();
    }

    function chequeoIntersticial() {
        contadorPreguntas++;
        if(contadorPreguntas >= 5) {
            if(window.AppInventor) {
                window.AppInventor.setWebViewString("MOSTRAR_INTERSTICIAL");
            }
            contadorPreguntas = 0;
        }
    }

    // LÃ“GICA DE PAGOS SEGURA ðŸ”’
    function procesarPago(monto, costo) {
        let email = document.getElementById('paypal-email').value;
        if(!email.includes("@")) return alert("Email no vÃ¡lido");
        if(monedas < costo) return alert("Monedas insuficientes");

        monedas -= costo;
        actualizarMonedas();

        // Enviamos los datos bloqueados a la App para que ella mande el mail
        let ticket = `PAGO|${email}|${monto}|${Date.now()}`;
        if(window.AppInventor) {
            window.AppInventor.setWebViewString(ticket);
        }
        alert("Solicitud enviada con Ã©xito.");
        irA('scr-home');
    }

    actualizarMonedas();
</script>
</body>
</html>
